<!DOCTYPE html><html data-greet="Welcome to inspect!"><head><meta charSet="utf-8"/><meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width"/><link rel="icon" href="/static/assets/favicon.fdc87f9e.png"/><title>芹也·Nginx 问题小记</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/66f28b40970f1260.css" as="style"/><link rel="stylesheet" href="/_next/static/css/66f28b40970f1260.css" data-n-g=""/><link rel="preload" href="/_next/static/css/fec7f9f37b0608db.css" as="style"/><link rel="stylesheet" href="/_next/static/css/fec7f9f37b0608db.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-e81585bb9a6b8f4d.js" defer=""></script><script src="/_next/static/chunks/framework-8383bf789d61bcef.js" defer=""></script><script src="/_next/static/chunks/main-dde6fc6da7e49e96.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b5e7abb3bc78eebd.js" defer=""></script><script src="/_next/static/chunks/7403-38b2a563d44f6dec.js" defer=""></script><script src="/_next/static/chunks/2939-b1d99e69c2fc2e3f.js" defer=""></script><script src="/_next/static/chunks/5865-a15794fb914bba3b.js" defer=""></script><script src="/_next/static/chunks/8629-7ebb719f09a0f781.js" defer=""></script><script src="/_next/static/chunks/8197-8093e9a7b2f62500.js" defer=""></script><script src="/_next/static/chunks/932-243b12d79b73ac1b.js" defer=""></script><script src="/_next/static/chunks/8348-7fb7ca135c7c37ec.js" defer=""></script><script src="/_next/static/chunks/6285-a28288fec9d300e7.js" defer=""></script><script src="/_next/static/chunks/1582-376df3a2db36a106.js" defer=""></script><script src="/_next/static/chunks/5336-e53cbdf4cc9bd3e0.js" defer=""></script><script src="/_next/static/chunks/6299-58cfc0e32b222490.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5BpostId%5D-0c0f3746c432cefd.js" defer=""></script><script src="/_next/static/b1721b0-20250209-114138/_buildManifest.js" defer=""></script><script src="/_next/static/b1721b0-20250209-114138/_ssgManifest.js" defer=""></script></head><body><div id="__next"><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><main class="AppPage_app-page__GNz5J"><main class="Post_post__iv4AP"><style data-emotion="css y263ea">.css-y263ea{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:-webkit-sticky;position:sticky;z-index:1100;top:0;left:auto;right:0;--AppBar-background:transparent;--AppBar-color:inherit;background-color:var(--AppBar-background);color:var(--AppBar-color);}</style><style data-emotion="css 12fvpgq">.css-12fvpgq{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:var(--Paper-shadow);background-image:var(--Paper-overlay);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:-webkit-sticky;position:sticky;z-index:1100;top:0;left:auto;right:0;--AppBar-background:transparent;--AppBar-color:inherit;background-color:var(--AppBar-background);color:var(--AppBar-color);}</style><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation0 MuiAppBar-root MuiAppBar-colorTransparent MuiAppBar-positionSticky SimpleAppBar_simple-app-bar__fgxHL SimpleAppBar_white-bg__ODZAB css-12fvpgq" style="--Paper-shadow:none"><style data-emotion="css awgou1">.css-awgou1{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:16px;padding-right:16px;min-height:56px;}@media (min-width:600px){.css-awgou1{padding-left:24px;padding-right:24px;}}@media (min-width:0px){@media (orientation: landscape){.css-awgou1{min-height:48px;}}}@media (min-width:600px){.css-awgou1{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular SimpleAppBar_toolbar__20Cik css-awgou1"><style data-emotion="css 2xhtwg">.css-2xhtwg{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(0, 0, 0, 0.04);margin-left:-12px;color:#ff5722;--IconButton-hoverBg:rgba(255, 87, 34, 0.04);}.css-2xhtwg:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-2xhtwg:hover{background-color:transparent;}}.css-2xhtwg.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css fvv0cg">.css-fvv0cg{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(0, 0, 0, 0.04);margin-left:-12px;color:#ff5722;--IconButton-hoverBg:rgba(255, 87, 34, 0.04);}.css-fvv0cg::-moz-focus-inner{border-style:none;}.css-fvv0cg.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-fvv0cg{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-fvv0cg:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-fvv0cg:hover{background-color:transparent;}}.css-fvv0cg.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-edgeStart MuiIconButton-sizeMedium css-fvv0cg" tabindex="0" type="button"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="HomeRoundedIcon"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1"></path></svg></button><style data-emotion="css 1e9zyph">.css-1e9zyph{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;color:#ff5722;}</style><h1 class="MuiTypography-root MuiTypography-h6 SimpleAppBar_title__TC1lj css-1e9zyph">Nginx 问题小记</h1><div class="SimpleAppBar_main-content__Uspj2"></div><div class="SimpleAppBar_extra-icons__XHc_f"><style data-emotion="css 17agyfa">.css-17agyfa{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(0, 0, 0, 0.04);color:#ff5722;--IconButton-hoverBg:rgba(255, 87, 34, 0.04);}.css-17agyfa:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-17agyfa:hover{background-color:transparent;}}.css-17agyfa.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css lfqs75">.css-lfqs75{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(0, 0, 0, 0.04);color:#ff5722;--IconButton-hoverBg:rgba(255, 87, 34, 0.04);}.css-lfqs75::-moz-focus-inner{border-style:none;}.css-lfqs75.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-lfqs75{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-lfqs75:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-lfqs75:hover{background-color:transparent;}}.css-lfqs75.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeMedium SimpleAppBar_extra-icon-portrait__H_vwg css-lfqs75" tabindex="0" type="button" aria-label="显示目录"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ViewSidebarRoundedIcon"><path d="M15 20H3c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1m4-12h2c.55 0 1-.45 1-1V5c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0 12h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1m0-6h2c.55 0 1-.45 1-1v-2c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1"></path></svg></button><style data-emotion="css 1f5p11z">.css-1f5p11z{z-index:1500;pointer-events:none;pointer-events:auto;pointer-events:none;}</style><style data-emotion="css 1vxh2dt">.css-1vxh2dt{z-index:1500;pointer-events:none;pointer-events:auto;pointer-events:none;}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeMedium css-lfqs75" tabindex="0" type="button" aria-label="菜单项"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuRoundedIcon"><path d="M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1m0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1"></path></svg></button></div></div></header><div class="Post_main__vp3Pv"><div class="Post_left-side__LZb2o"><div class="BlogTags_blog-tags__8sshV"><style data-emotion="css 6042cn">.css-6042cn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.57;letter-spacing:0.00714em;color:#00897b;}</style><span class="MuiTypography-root MuiTypography-subtitle2 BlogTags_tag__1dJYW css-6042cn">#<!-- -->Nginx</span><style data-emotion="css 6042cn">.css-6042cn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.57;letter-spacing:0.00714em;color:#00897b;}</style><span class="MuiTypography-root MuiTypography-subtitle2 BlogTags_tag__1dJYW css-6042cn">#<!-- -->Mac</span><style data-emotion="css 6042cn">.css-6042cn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.57;letter-spacing:0.00714em;color:#00897b;}</style><span class="MuiTypography-root MuiTypography-subtitle2 BlogTags_tag__1dJYW css-6042cn">#<!-- -->Linux</span></div><style data-emotion="css d11o3o">.css-d11o3o{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;background-color:transparent;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:6px 16px;font-weight:500;background-color:#ed6c02;color:#fff;}</style><style data-emotion="css aucmfj">.css-aucmfj{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;box-shadow:var(--Paper-shadow);background-image:var(--Paper-overlay);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;background-color:transparent;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:6px 16px;font-weight:500;background-color:#ed6c02;color:#fff;}</style><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation0 MuiAlert-root MuiAlert-colorWarning MuiAlert-filledWarning MuiAlert-filled Post_outdated-alert__kzEx8 css-aucmfj" role="alert" style="--Paper-shadow:none"><style data-emotion="css 131is6g">.css-131is6g{margin-right:12px;padding:7px 0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:22px;opacity:0.9;}</style><div class="MuiAlert-icon css-131is6g"><style data-emotion="css 1l6e05h">.css-1l6e05h{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:inherit;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeInherit css-1l6e05h" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ReportProblemOutlinedIcon"><path d="M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"></path></svg></div><style data-emotion="css 127h8j3">.css-127h8j3{padding:8px 0;min-width:0;overflow:auto;}</style><div class="MuiAlert-message css-127h8j3">本文最后更新于<!-- -->1666<!-- -->天前，其中所描述的信息可能已发生改变，请谨慎参考。</div></div><style data-emotion="css 1y3scyc">.css-1y3scyc{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.75rem;line-height:1.66;letter-spacing:0.03333em;color:rgba(0, 0, 0, 0.6);margin-bottom:0.35em;}</style><span class="MuiTypography-root MuiTypography-caption MuiTypography-gutterBottom css-1y3scyc">我在本地安装 Nginx 的主要目的是使用它的作为静态 web server，通过链接文件到 Nginx root 目录下，可以实现局域网内文件下载，静态页面测试等操作。但 Nginx 的用途不止于此，这里记录一些使用 Nginx 遇到的问题。</span><article class="ArticleDisplay_article-display__x_8BH"><style data-emotion="css 95orn8">.css-95orn8{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;color:#ff5722;margin-bottom:0.35em;}</style><h1 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom ArticleDisplay_heading__pegPx css-95orn8"><div class="ArticleDisplay_anchor-symbol__u8t7V"><div id="1|Mac 安装 Nginx" class="ArticleDisplay_anchor__92Eok"></div><style data-emotion="css 1b3xt71">.css-1b3xt71{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:inherit;}</style><a class="MuiTypography-root MuiTypography-body1 ArticleDisplay_anchor-icon__0DTu7 css-1b3xt71" href="#1|Mac 安装 Nginx"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkRoundedIcon"><path d="M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5m-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1m2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1"></path></svg></a></div>Mac 安装 Nginx</h1>
<style data-emotion="css 525y4q">.css-525y4q{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;color:#ff5722;margin-bottom:0.35em;}</style><h2 class="MuiTypography-root MuiTypography-h4 MuiTypography-gutterBottom ArticleDisplay_heading__pegPx css-525y4q"><div class="ArticleDisplay_anchor-symbol__u8t7V"><div id="1.1|使用 brew 安装与管理 Nginx" class="ArticleDisplay_anchor__92Eok"></div><style data-emotion="css 1b3xt71">.css-1b3xt71{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:inherit;}</style><a class="MuiTypography-root MuiTypography-body1 ArticleDisplay_anchor-icon__0DTu7 css-1b3xt71" href="#1.1|使用 brew 安装与管理 Nginx"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkRoundedIcon"><path d="M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5m-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1m2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1"></path></svg></a></div>使用 brew 安装与管理 Nginx</h2>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">使用<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">brew install nginx</code>即可一键安装 Nginx。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">Homebrew 同时提供了<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">brew services</code>命令，有些类似<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">systemctl</code>，可以方便管理 Nginx 这类需要作为服务运行的软件。</p>
<pre><pre class="CodeView_code-view__SNK0p"><code class="hljs CodeView_code__2HQrc"><span class="hljs-meta prompt_">$ </span><span class="language-bash">brew services start nginx <span class="hljs-comment"># 注册并启动Nginx服务，相当于systemctl enable nginx &amp;&amp; systemctl start nginx</span></span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash">brew services stop nginx  <span class="hljs-comment"># 注销并停止Nginx服务，相当于systemctl disable nginx &amp;&amp; systemctl stop nginx</span></span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash">brew services restart nginx <span class="hljs-comment"># 重启Nginx服务，相当于systemctl restart nginx</span></span>
</code></pre></pre>
<style data-emotion="css 525y4q">.css-525y4q{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;color:#ff5722;margin-bottom:0.35em;}</style><h2 class="MuiTypography-root MuiTypography-h4 MuiTypography-gutterBottom ArticleDisplay_heading__pegPx css-525y4q"><div class="ArticleDisplay_anchor-symbol__u8t7V"><div id="1.2|Nginx 配置" class="ArticleDisplay_anchor__92Eok"></div><style data-emotion="css 1b3xt71">.css-1b3xt71{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:inherit;}</style><a class="MuiTypography-root MuiTypography-body1 ArticleDisplay_anchor-icon__0DTu7 css-1b3xt71" href="#1.2|Nginx 配置"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkRoundedIcon"><path d="M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5m-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1m2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1"></path></svg></a></div>Nginx 配置</h2>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">根据自身需要，对 Nginx 配置中<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">location</code>做如下修改。</p>
<pre><pre class="CodeView_code-view__SNK0p"><code class="hljs CodeView_code__2HQrc"><span class="hljs-section">location</span> / {
    <span class="hljs-comment"># 配置局域网访问规则：</span>
    <span class="hljs-comment"># allow和deny的配置类似iptable，自上往下匹配，命中则结束</span>
    <span class="hljs-comment"># 这里的配置下localhost的访问会命中第一条而被允许访问，其他来源的访问会命中deny而被拒绝</span>
    <span class="hljs-comment"># 如果希望允许来自局域网下的访问，则可以关闭deny all规则</span>
    <span class="hljs-attribute">allow</span>       <span class="hljs-number">127.0.0.1</span>;
    <span class="hljs-attribute">deny</span>        all;
    <span class="hljs-comment"># 使用自定义的root目录</span>
    <span class="hljs-attribute">root</span>        /Users/EAGzzyCSL/my/nginxHome/;
    <span class="hljs-attribute">index</span>       index.html index.htm;
    <span class="hljs-comment"># 开启autoindex，可以直接列出目录下的文件方便查看</span>
    <span class="hljs-attribute">autoindex</span>   <span class="hljs-literal">on</span>;
}
</code></pre></pre>
<style data-emotion="css 525y4q">.css-525y4q{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;color:#ff5722;margin-bottom:0.35em;}</style><h2 class="MuiTypography-root MuiTypography-h4 MuiTypography-gutterBottom ArticleDisplay_heading__pegPx css-525y4q"><div class="ArticleDisplay_anchor-symbol__u8t7V"><div id="1.3|Nginx 端口设置" class="ArticleDisplay_anchor__92Eok"></div><style data-emotion="css 1b3xt71">.css-1b3xt71{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:inherit;}</style><a class="MuiTypography-root MuiTypography-body1 ArticleDisplay_anchor-icon__0DTu7 css-1b3xt71" href="#1.3|Nginx 端口设置"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkRoundedIcon"><path d="M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5m-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1m2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1"></path></svg></a></div>Nginx 端口设置</h2>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">一直以来，Nginx 在 Mac 下的默认端口为 <style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">8080</code>，因为 Mac 限定了非 root 级权限不能使用 1024 ，而 brew 启动的 Nginx 是以 user 身份运行的。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">但<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">http://localhost:8080</code>显然不如<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">http://localhost</code>方便与美观，好在 Mojave 10.14 之后这一限制被取消了，因此直接修改<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">listen</code>字段即可。</p>
<pre><pre class="CodeView_code-view__SNK0p"><code class="hljs CodeView_code__2HQrc">server {
<span class="hljs-code">    listen  80;
}
</span></code></pre></pre>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">关于限制被取消的说法我也是道听途说，只找到了下面两条有限的资料，但验证了使用 80 端口确实可行。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><ul class="MuiTypography-root MuiTypography-body1 ArticleDisplay_list__oaoxj css-fyswvn">
<li class="MuiTypography-root MuiTypography-body1 css-fyswvn"><style data-emotion="css 51dzfh">.css-51dzfh{-webkit-text-decoration:none;text-decoration:none;}.css-51dzfh:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css 1l4g0f0">.css-1l4g0f0{margin:0;font:inherit;line-height:inherit;letter-spacing:inherit;color:#00897b;-webkit-text-decoration:none;text-decoration:none;}.css-1l4g0f0:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover ArticleDisplay_link__nEldZ css-1l4g0f0" href="https://news.ycombinator.com/item?id=18302380" rel="noreferrer" target="_blank">MacOS Mojave 10.14 no longer enforces privileged ports</a></li>
<li class="MuiTypography-root MuiTypography-body1 css-fyswvn"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover ArticleDisplay_link__nEldZ css-1l4g0f0" href="http://shaofan.org/mac-bind-80-port/" rel="noreferrer" target="_blank">Mac OS 普通用户启动 80 端口(Mojave 10.14 原生支持)</a></li>
</ul>
<style data-emotion="css 95orn8">.css-95orn8{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:3rem;line-height:1.167;letter-spacing:0em;color:#ff5722;margin-bottom:0.35em;}</style><h1 class="MuiTypography-root MuiTypography-h3 MuiTypography-gutterBottom ArticleDisplay_heading__pegPx css-95orn8"><div class="ArticleDisplay_anchor-symbol__u8t7V"><div id="2|403 问题说明" class="ArticleDisplay_anchor__92Eok"></div><style data-emotion="css 1b3xt71">.css-1b3xt71{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:inherit;}</style><a class="MuiTypography-root MuiTypography-body1 ArticleDisplay_anchor-icon__0DTu7 css-1b3xt71" href="#2|403 问题说明"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkRoundedIcon"><path d="M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5m-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1m2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1"></path></svg></a></div>403 问题说明</h1>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">Nginx 配置经常会遇到 403 问题，其中一种常见的情况是权限问题。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">在 unix 下，cd 到某个目录需要对该目录拥有<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">x</code>权限。因此 Nginx 需要<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">rx</code>权限来探测和读取 Nginx root 目录下的内容，如果 Nginx 对配置的 root 目录及上层、上上层目录没有<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">rx</code>权限，就会出现 403 问题。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">在不同操作系统中和不同配置下，Nginx 的主进程和 worker 进程会以不同身份运行，其中 root 目录内容的读取是由 worker 进程负责。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">可以通过<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">ps aux | grep nginx</code>查看执行<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">nginx</code>和执行<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">sudo nginx</code>进程状态的不同。（PS：可以通过<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">nginx -s reload</code>和<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">nginx -s stop</code>重启或结束 Nginx）</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">当 Nginx 主进程以 root 身份运行时，worker 进程会按照<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">nginx.config</code>中配置的<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">user</code>身份运行。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">当 Nginx 主进程以非 root 身份运行时，worker 进程会忽略<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">nginx.config</code>中配置的<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">user</code>身份。这时 Nginx 会输出如下的 warning。</p>
<style data-emotion="css 1odagel">.css-1odagel{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.6);}</style><blockquote class="MuiTypography-root MuiTypography-body1 QuoteView_quote-view__5sRgi css-1odagel" style="border-left:solid 4px rgb(51, 160, 149)">
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">the &quot;user&quot; directive makes sense only if the master process runs with super-user privileges, ignored in /usr/local/etc/nginx/nginx.conf</p>
</blockquote>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">在 Mac 下，<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">brew services start nginx</code>默认以当前用户身份运行 Nginx， worker 进程可以正常读取<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">~</code>目录下的文件夹，因此如果配置 Nginx root 为<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">~</code>下目录则不会因此遇到 403 问题。</p>
<style data-emotion="css 525y4q">.css-525y4q{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;color:#ff5722;margin-bottom:0.35em;}</style><h2 class="MuiTypography-root MuiTypography-h4 MuiTypography-gutterBottom ArticleDisplay_heading__pegPx css-525y4q"><div class="ArticleDisplay_anchor-symbol__u8t7V"><div id="2.1|Linux 下 403" class="ArticleDisplay_anchor__92Eok"></div><style data-emotion="css 1b3xt71">.css-1b3xt71{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:inherit;}</style><a class="MuiTypography-root MuiTypography-body1 ArticleDisplay_anchor-icon__0DTu7 css-1b3xt71" href="#2.1|Linux 下 403"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkRoundedIcon"><path d="M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5m-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1m2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1"></path></svg></a></div>Linux 下 403</h2>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">在 Linux 下，<style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">nginx.config</code>中<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">user</code>字段默认为<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">html</code>，也就意味着如果以 root 身份启动 Nginx，worker 进程将以 html 身份运行，此时如果以<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">~</code>目录下的文件夹作为 Nginx root，则会因为<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">~</code>文件夹权限是<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">rwx------</code>而无法被用户<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">html</code>访问导致 403。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">根据前面对 403 的原因分析，可以有以下几种解决方案。</p>
<style data-emotion="css fyswvn">.css-fyswvn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><ul class="MuiTypography-root MuiTypography-body1 ArticleDisplay_list__oaoxj css-fyswvn">
<li class="MuiTypography-root MuiTypography-body1 css-fyswvn">
<p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">为 <style data-emotion="css usxzyy">.css-usxzyy{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:#00897b;}</style><code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">html</code> 用户添加<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">~</code>目录的<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">rx</code>权限。这种做法需要对<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">~</code>目录进行权限修改不太推荐。</p>
</li>
<li class="MuiTypography-root MuiTypography-body1 css-fyswvn">
<p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">使用非 root 身份运行 Nginx 主进程。<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">systemctl enable nginx</code>默认使用 root 身份，使用非 root 身份单独配置即可。</p>
</li>
<li class="MuiTypography-root MuiTypography-body1 css-fyswvn">
<p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">使用<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">/var</code>下的目录作为 Nginx root。<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">/var</code>的权限是<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">rwxr-xr-x</code>因此可以被用户 <code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">html</code> 正常访问，可以通过软连接方式把<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">~</code>下目录连接到<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">/var</code>目录下。</p>
</li>
<li class="MuiTypography-root MuiTypography-body1 css-fyswvn">
<p class="MuiTypography-root MuiTypography-body1 ArticleDisplay_paragraph__JVeTs css-fyswvn">使用非 root 身份运行 Nginx worker 进程。注意<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">user</code>字段的格式为<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">user user [group];</code>，如果省略 group 则默认 group 与 user 同名，因此需要写明 group，比如我使用的配置为<code class="MuiTypography-root MuiTypography-body1 CodeView_inline-code-view___LhIm css-usxzyy">user eagzzycsl users;</code>。</p>
</li>
</ul></article><div class="Discussion_discussion__BnFit"><div id="disqus_thread"></div></div></div><div class="Post_right-side__oT7Bg"><div class="Post_catalogue-container__Hj8qQ"><style data-emotion="css 1o42oo9">.css-1o42oo9{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.57;letter-spacing:0.00714em;color:rgba(0, 0, 0, 0.6);}</style><section class="MuiTypography-root MuiTypography-subtitle2 Catalogue_catalogue__XGNiU css-1o42oo9"><style data-emotion="css 1e9zyph">.css-1e9zyph{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;color:#ff5722;}</style><h1 class="MuiTypography-root MuiTypography-h6 Catalogue_title__RJ9Hw css-1e9zyph">目录</h1><div class="Catalogue_content__qPLV6"><ol class="Catalogue_list__VyaeG"><li class="Catalogue_list-item__dDdXk"><style data-emotion="css bu6if1">.css-bu6if1{-webkit-text-decoration:none;text-decoration:none;color:inherit;}</style><style data-emotion="css 7g4353">.css-7g4353{margin:0;font:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;-webkit-text-decoration:none;text-decoration:none;color:inherit;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone Catalogue_link__dlVgL css-7g4353" href="#1|Mac 安装 Nginx">Mac 安装 Nginx</a><ol class="Catalogue_list__VyaeG"><li class="Catalogue_list-item__dDdXk"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone Catalogue_link__dlVgL css-7g4353" href="#1.1|使用 brew 安装与管理 Nginx">使用 brew 安装与管理 Nginx</a><ol class="Catalogue_list__VyaeG"></ol></li><li class="Catalogue_list-item__dDdXk"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone Catalogue_link__dlVgL css-7g4353" href="#1.2|Nginx 配置">Nginx 配置</a><ol class="Catalogue_list__VyaeG"></ol></li><li class="Catalogue_list-item__dDdXk"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone Catalogue_link__dlVgL css-7g4353" href="#1.3|Nginx 端口设置">Nginx 端口设置</a><ol class="Catalogue_list__VyaeG"></ol></li></ol></li><li class="Catalogue_list-item__dDdXk"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone Catalogue_link__dlVgL css-7g4353" href="#2|403 问题说明">403 问题说明</a><ol class="Catalogue_list__VyaeG"><li class="Catalogue_list-item__dDdXk"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone Catalogue_link__dlVgL css-7g4353" href="#2.1|Linux 下 403">Linux 下 403</a><ol class="Catalogue_list__VyaeG"></ol></li></ol></li></ol></div></section></div></div><style data-emotion="css 14yoxd">.css-14yoxd{z-index:1200;}</style></div></main><style data-emotion="css 110i50s">.css-110i50s{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;box-shadow:var(--Paper-shadow);background-image:var(--Paper-overlay);}</style><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation3 CornerFooter_corner-footer__fsd6P css-110i50s" style="--Paper-shadow:0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12)"><style data-emotion="css 2rta8y">.css-2rta8y{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(0, 0, 0, 0.04);padding:5px;font-size:1.125rem;}.css-2rta8y:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-2rta8y:hover{background-color:transparent;}}.css-2rta8y.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css oofez5">.css-oofez5{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;--IconButton-hoverBg:rgba(0, 0, 0, 0.04);padding:5px;font-size:1.125rem;}.css-oofez5::-moz-focus-inner{border-style:none;}.css-oofez5.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-oofez5{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-oofez5:hover{background-color:var(--IconButton-hoverBg);}@media (hover: none){.css-oofez5:hover{background-color:transparent;}}.css-oofez5.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeSmall CornerFooter_expand-button__G_DAW css-oofez5" tabindex="0" type="button"><style data-emotion="css q7mezt">.css-q7mezt{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;fill:currentColor;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-q7mezt" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LaunchRoundedIcon"><path d="M18 19H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h5c.55 0 1-.45 1-1s-.45-1-1-1H5c-1.11 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1v5c0 .55-.45 1-1 1M14 4c0 .55.45 1 1 1h2.59l-9.13 9.13c-.39.39-.39 1.02 0 1.41s1.02.39 1.41 0L19 6.41V9c0 .55.45 1 1 1s1-.45 1-1V3h-6c-.55 0-1 .45-1 1"></path></svg></button></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postId":"nginx-issues"},"__N_SSG":true},"page":"/blog/[postId]","query":{"postId":"nginx-issues"},"buildId":"b1721b0-20250209-114138","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>